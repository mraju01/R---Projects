title="Final Project - ALY 6010"



```{r message=FALSE, warning=FALSE}

# Library Used for M3 Project
#####################################
library(magrittr) ## Fetching magnittr
library(knitr)
library(tidyverse)
library(plyr)
library(dplyr)
library(readxl)
library(gridExtra)
library(RColorBrewer)
library(lattice)
library(ggplot2)
library(summarytools)
library(DT)
library(kableExtra)
```

kaggle.com/datasets/uciml/autompg-dataset
Task 2.1
```{r message=FALSE, warning=FALSE}



#### Outocome of summarytools::descr()
###################################
table2.1 <- mpg %>%
    summarytools::descr() %>%
    t()

table1 <- round((table2.1), digits = 2)


# Present the table using kableExta Package
knitr::kable(table1,
    caption = "Table 1: Descriptive Statistics of MPG ",
    format = "html",
    table.attr = "style=width: 40%",
    font_size = 8
) %>%
    kable_styling(bootstrap_options = c(
        "striped", "hover",
        "condensed", "responsive"
    )) %>%
    kable_classic(
        full_width = F,
        html_font = "Times New Roman"
    )


#### Outocome of psych::describe ()
###################################
table2.2 <- mpg %>%
    psych::describe()

table2 <- round((table2.2), digits = 2)


# Present the table using kableExta Package
knitr::kable(table2,
    caption = "Table 1: Descriptive Statistics of MPG ",
    format = "html",
    table.attr = "style=width: 40%",
    font_size = 8
) %>%
    kable_styling(bootstrap_options = c(
        "striped", "hover",
        "condensed", "responsive"
    )) %>%
    kable_classic(
        full_width = F,
        html_font = "Times New Roman"
    )
```

Task 2.2

```{r message=FALSE, warning=FALSE}


unique(mpg$cyl)

# Using mpg data set
# Plot and observe relationship between engine size and displ
# Start by grouping by the different engine sizes

detach(package:plyr)
table2.2 <- mpg %>%
    group_by(CylinderSize = cyl) %>%
    summarise(
        Mean = mean(displ),
        SD = sd(displ),
        Minimum = min(displ),
        Maximum = max(displ)
    )

table2.2 %>%
    kable(
        align = "c",
        caption = "Table 2: Descriptive values of displacement per cylinders",
        format = "html",
        digits = 2,
        table.attr = "style='width:60%;'"
    ) %>%
    kable_classic_2(
        bootstrap_options = c("hover", "bordered", "condensed"),
        html_font = "Cambria",
        position = "center",
        font_size = 12
    ) %>%
    add_header_above(c(" " = 1, "Displacement" = 4))
```

Task2.3



```{r message=FALSE, warning=FALSE}


# Creating table for r value

n2.3 <- length(mpg$displ)

YDisplacement <- c(mpg$displ)

XCylinder <- c(mpg$cyl)

XY <- c(XCylinder * YDisplacement)

X_Square <- c(XCylinder^2)

Y_Square <- c(YDisplacement^2)


Table2.3 <- matrix(c(XCylinder, YDisplacement, XY, X_Square, Y_Square),
    nrow = n2.3,
    byrow = FALSE
)


## Naming Columns and Row Names in Table#######
colnames(Table2.3) <- c("Cylinder", "Displacement", "Cylinder*Displacement", "Square of Cylinder", "Square of Displacement") # nolint


# Table Creation of of Matrix Using Knitr Package##################
######################################################
Table2.3 %>%
    head() %>%
    knitr::kable(
        caption = "Table : Descriptive Statistics of Sleep Quality",
        format = "html"
    ) %>%
    kable_material_dark(
        full_width = F,
        html_font = "Times New Roman"
    )

# Creating Objects for Calculation of R
SumXCylinder <- sum(XCylinder)
SumYDisplacement <- sum(YDisplacement)
SumXY <- sum(XY)
SumX_Square <- sum(X_Square)
SumY_Square <- sum(Y_Square)


correlationDisplCyl <- ((n2.3 * SumXY) - ((SumXCylinder) * (SumYDisplacement))) / sqrt(((n2.3 * SumX_Square) - (SumXCylinder^2)) * ((n2.3 * SumY_Square) - (SumYDisplacement^2)))

correlationDisplCyl

determinationDisplCyl <- correlationDisplCyl^2
determinationDisplCyl

correlation <- cor(mpg$displ, mpg$cyl)
correlation
```

Task 2.4




Task 2.5
```{r message=FALSE, warning=FALSE}

XDisplacement <- c(mpg$displ)

YCylinder <- c(mpg$cyl)

linearReg <- lm(YCylinder ~ XDisplacement)

SumData <- summary(linearReg)
SumData
names(SumData)

SumData$coefficients

Intercept <- SumData$coefficients[[1]]
Intercept
Slope <- SumData$coefficients[[2]]
Slope


paste("The linear regression equation for YCyclinder = ", round(Intercept, digits = 3), "+", round(Slope, digits = 3), "*", "XDisplacement")
```

Task 2.6

```{r message=FALSE, warning=FALSE}

YDisplacement <- c(mpg$displ)

XCylinder <- c(mpg$cyl)

linearReg <- lm(YDisplacement ~ XCylinder)
SumData <- summary(linearReg)
SumData
names(SumData)

SumData$coefficients

Intercept2.6 <- SumData$coefficients[[1]]
Intercept2.6
Slope2.6 <- SumData$coefficients[[2]]
Slope2.6


plot(
    YDisplacement ~ XCylinder,
    pch = 4,
    xlim = c(0, 8),
    ylim = c(-2, 8)
)

abline(linearReg, col = "#99004C", lty = 1, lwd = 1)
abline(v = 0, lwd = 2)
abline(h = 0, lwd = 2)
abline(h = Intercept2.6)
abline(h = mean(YDisplacement), col = "Yellow")
abline(h = median(YDisplacement), col = "Purple")


# Add text to the line later
```

Task 2.7 
```{r message=FALSE, warning=FALSE}

YDisplacement <- c(mpg$displ)

XCylinder <- c(mpg$cyl)

YDisplacementPedict <- Intercept2.6 + (XCylinder * Slope2.6)

Residual <- YDisplacement - YDisplacementPedict


Table2.7 <- matrix(c(XCylinder, YDisplacement, YDisplacementPedict, Residual),
    nrow = n2.3,
    byrow = FALSE
)


## Naming Columns and Row Names in Table#######
colnames(Table2.7) <- c("Cylinder", "Displacement", "Predicted Value of Y", "Residual")


# Table Creation of of Matrix Using Knitr Package##################
######################################################
Table2.7 %>%
    head(20) %>%
    knitr::kable(
        caption = "Table : Descriptive Statistics of Sleep Quality",
        format = "html"
    ) %>%
    kable_material_dark(
        full_width = F,
        html_font = "Times New Roman"
    )
```

Task 2.8

```{r message=FALSE, warning=FALSE}

# "Create the vector for Frequency, Cumulative Frequency, Percentage, Cumulative Percentage

Table2.8 <- mpg$cyl %>%
    table() %>%
    as.data.frame() %>%
    rename(Column1 = Freq) %>%
    mutate(
        Column2 = cumsum(Column1),
        Column3 = (Column1 / nrow(mpg)) * 100,
        Column4 = cumsum(Column3)
    )


# Present the table"
knitr::kable(Table2.8,
    digits = 2,
    caption = "Frequency and Percentage Table for Cylinder Size",
    col.names = c("Cylinder Size", "Frequency", "Cumulative Frequency", "Percentage", "Cumulative Percentage"),
    format = "html",
    table.attr = "style=width: 40%", align = "c"
) %>%
    kable_material(c("striped", "hover"))
```



Task 2.9

```{r message=FALSE, warning=FALSE}

```

Task 2.10

```{r message=FALSE, warning=FALSE}

```

Part 3 :Multiple Regresssion


Task 3.1
```{r message=FALSE, warning=FALSE}

patient_id <- c("PK01", "PK02", "PK03", "PK04", "PK05", "PK06", "PK07", "PK08", "PK09", "PK10", "PK11", "PK12", "PK13", "PK14", "PK15")
Ysystolic_bp <- c(112, 156, 125, 145, 155, 162, 139, 144, 153, 126, 169, 132, 143, 153, 162)
X1age <- c(45, 60, 55, 60, 62, 71, 57, 59, 64, 42, 75, 52, 59, 67, 73)
X2weight <- c(135, 182, 148, 182, 190, 232, 194, 182, 217, 171, 225, 173, 184, 194, 211)

linearReg3.1 <- lm(Ysystolic_bp ~ X1age + X2weight)

SumData3.1 <- summary(linearReg3.1)

SumData3.1

names(SumData3.1)

SumData3.1$coefficients

Intercept3.1 <- SumData3.1$coefficients[[1]]

Intercept3.1

X1Slope <- SumData3.1$coefficients[[2]]
X1Slope

X2Slope <- SumData3.1$coefficients[[3]]
X2Slope


paste("The multiple regression equation = ", round(Intercept3.1, digits = 3), "+", round(X1Slope, digits = 3), "*", "X1age", "+", round(X2Slope, digits = 3), "*", "X2weight")


# Correlation Cofficient of age between systolic_bp and age


data <- data.frame(X1age, X2weight, Ysystolic_bp)
cor(data)

cor_age_systolicbp <- cor(X1age, Ysystolic_bp)
cor_age_systolicbp
cor_age_with_systolicbp <- cor(X1age + Ysystolic_bp, X2weight)
cor_age_with_systolicbp


deter_age_systolicbp <- cor_age_systolicbp^2

deter_age_with_systolicbp <- cor_age_with_systolicbp^2


# Vector Creation
VectorCor <- c(cor_age_systolicbp, cor_age_with_systolicbp)
VectorDeter <- c(deter_age_systolicbp, deter_age_with_systolicbp)


# Matrix Creation for Table#####
######################################################
Table3.1 <- matrix(c(VectorCor, VectorDeter),
    nrow = 2,
    byrow = FALSE
)


# Rounding Digits in Matrix##################
######################################################
Table3.1_Rounded <- round(Table3.1, digits = 2)

## Naming Columns and Row Names in Table#######
colnames(Table3.1_Rounded) <- c("Correlation", "Determination")

rownames(Table3.1_Rounded) <- c("Age~SystBP", "Age+SystBP~Weight")


# Table Creation of of Matrix Using Knitr Package##################
######################################################
Table3.1_Rounded %>%
    knitr::kable(
        caption = "Table 2 : Descriptive Statistics of Populations and Sample 1",
        format = "html"
    ) %>%
    kable_material_dark(
        full_width = F,
        html_font = "Times New Roman"
    )


MultipleR_Squared <- SumData3.1$r.squared

paste("The Value of multiple R square is", round(MultipleR_Squared, digits = 2))

MultipleR <- sqrt(MultipleR_Squared)

paste("The Value of multiple R is", round(MultipleR, digits = 2))


# Calculation F-Test Value

n3.1 <- length(patient_id)
k <- 2


F_Test <- (MultipleR_Squared / k) / ((1 - MultipleR_Squared) / (n3.1 - k - 1))

F_Test

## Performing Hypothesis Testing is used to test the significance of R
# The hypothesis are
# H0 :𝜌=0 and
# H1 :𝜌≠0
# where 𝜌 represents the population correlation coefficient for multiple correlation.


# Calculating the Critical Value for alpha value of 0.05

## Creating Objects for calculation of critical value

dfN <- n3.1 - k
dfD <- n3.1 - k - 1
alpha <- 0.05

# Calculating the right critical value as F-test value is positive

r_cv <- qf(alpha, dfN, dfD, lower.tail = FALSE)

r_cv
```



SumData
names(SumData)

SumData$coefficients

Intercept <- SumData$coefficients[[1]]
Intercept
Slope <- SumData$coefficients[[2]]
Slope


paste("The linear regression equation for YCyclinder = ", round(Intercept, digits = 3), "+", round(Slope, digits = 3), "*", "XDisplacement")